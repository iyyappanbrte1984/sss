<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ocean Explorer Pro ‚Äî SMART VISION</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    :root{
      --ocean-900:#032735; --ocean-700:#0b74de; --ocean-500:#39a1ff;
      --bg:#f4f9ff; --card:#ffffff; --muted:#6f8396;
      --ok:#1eae60; --warn:#f5a623; --bad:#e63946;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    html,body{font-family:"Poppins",sans-serif;background:var(--bg);color:var(--ocean-900);height:100%;}
    body{display:flex;flex-direction:column;}

    nav{
      position:sticky;top:0;z-index:1000;
      display:flex;justify-content:center;gap:24px;padding:12px 24px;
      background:linear-gradient(90deg,#0077be,#00a8e8);
      box-shadow:0 4px 12px rgba(0,0,0,0.1);
    }
    nav a{
      color:#fff;text-decoration:none;font-weight:700;font-size:16px;
      padding:8px 20px;border-radius:999px;transition:all .3s;
    }
    nav a:hover{background:rgba(255,255,255,0.2);transform:translateY(-2px);}

    .hero-header{
      padding:28px 16px 20px;text-align:center;
      background:linear-gradient(135deg,#005fa3,#00a8e8,#39a1ff);
      color:#fff;box-shadow:0 8px 24px rgba(0,0,0,0.15);
    }
    .hero-header h1{font-size:30px;font-weight:900;letter-spacing:.06em;margin-bottom:6px;}
    .hero-header p{font-size:14px;opacity:.96;}

    main.wrap{
      max-width:1400px;margin:24px auto 30px;padding:0 20px;flex:1;width:100%;
      display:flex;flex-direction:column;gap:16px;
    }

    .layout{
      display:grid;grid-template-columns:340px 1fr;gap:18px;
    }
    @media(max-width:1000px){
      .layout{grid-template-columns:1fr;}
      .side-panel{order:2;}
    }

    .side-panel{
      background:#fff;border-radius:16px;padding:18px;
      box-shadow:0 10px 30px rgba(0,0,0,0.06);
      border:1px solid rgba(0,119,190,0.08);
      max-height:700px;overflow-y:auto;
    }
    .side-panel h2{
      font-size:18px;margin-bottom:10px;color:var(--ocean-900);
    }
    .side-panel small{color:var(--muted);font-size:12px;}

    .layer-group{margin-top:14px;}
    .layer-group h3{
      font-size:13px;text-transform:uppercase;
      letter-spacing:.08em;color:var(--muted);margin-bottom:6px;
    }
    .layer-item{
      display:flex;align-items:center;justify-content:space-between;
      margin-bottom:8px;font-size:13px;padding:6px 8px;border-radius:8px;
      transition:background .2s;
    }
    .layer-item:hover{background:#f9fbff;}
    .layer-item label{display:flex;align-items:center;gap:8px;cursor:pointer;flex:1;}
    .layer-chip{
      width:10px;height:10px;border-radius:50%;flex-shrink:0;
    }
    .chip-nasa-chl{background:#00b894;}
    .chip-nasa-sst{background:#ff7675;}
    .chip-noaa-sst{background:#fd79a8;}
    .chip-plastic{background:#e63946;}
    .chip-currents{background:#0984e3;}
    .chip-turb{background:#6c5ce7;}
    .chip-mpa{background:#fdcb6e;}

    .source-tag{
      font-size:10px;background:#eef6fb;padding:2px 6px;border-radius:4px;
      margin-left:4px;color:#0b74de;font-weight:600;
    }

    #map{
      width:100%;height:600px;
      border-radius:16px;overflow:hidden;
      box-shadow:0 10px 30px rgba(0,0,0,0.06);
      border:1px solid rgba(0,119,190,0.08);
    }

    .controls-bar{
      margin-top:10px;
      display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;
      gap:10px;font-size:12px;
    }
    .slider-wrap{
      display:flex;align-items:center;gap:8px;
      background:#fff;border-radius:999px;
      padding:8px 14px;
      box-shadow:0 8px 20px rgba(0,0,0,0.05);
      border:1px solid rgba(0,119,190,0.08);
    }
    .slider-wrap input[type="range"]{width:180px;}
    .badge{
      display:inline-block;padding:4px 10px;border-radius:999px;
      font-size:11px;font-weight:600;
    }
    .badge-ok{background:rgba(30,174,96,0.12);color:var(--ok);}
    .badge-warn{background:rgba(245,166,35,0.12);color:var(--warn);}
    .badge-bad{background:rgba(230,57,70,0.12);color:var(--bad);}

    .btn{
      padding:8px 14px;border-radius:8px;border:none;font-weight:700;font-size:13px;
      cursor:pointer;transition:all .3s;
      background:linear-gradient(135deg,#39a1ff,#0b74de);color:#fff;
    }
    .btn:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(11,116,222,.3);}

    .popup-content{font-size:13px;line-height:1.6;}
    .popup-content strong{display:block;margin-bottom:4px;color:var(--ocean-900);}
    .popup-ai{
      margin-top:8px;padding:8px;background:#f9fbff;border-radius:6px;
      font-size:12px;color:var(--muted);
    }

    .legend-box{
      background:#fff;padding:10px;border-radius:8px;
      box-shadow:0 4px 12px rgba(0,0,0,0.08);
      font-size:11px;max-width:300px;
    }
    .legend-item{display:flex;align-items:center;gap:6px;margin-bottom:4px;}
    .legend-color{width:14px;height:14px;border-radius:3px;}

    @keyframes pulse{
      0%,100%{opacity:1;transform:scale(1);}
      50%{opacity:0.8;transform:scale(1.05);}
    }
    .live-indicator{
      display:inline-block;width:8px;height:8px;background:#00b894;
      border-radius:50%;animation:pulse 2s infinite;
      margin-left:6px;
    }
  </style>
</head>
<body>
  <nav>
    <a href="index.html">Home</a>
    <a href="live-demo.html">Live Demo</a>
    <a href="marine-dashboard.html">Marine AI Dashboard</a>
    <a href="ocean-explorer.html">Ocean Explorer</a>
    <a href="ocean-explorer-pro.html">Ocean Explorer Pro</a>
    <a href="pollution-pathways.html">Pollution Pathways</a>
    <a href="biodiversity-awareness.html">Red List & Self‚ÄëAssessment</a>
    <a href="sdg-dashboard.html">SDG & Biodiversity</a>
    <a href="presentation-mode.html">Presentation Mode</a>   
  </nav>

  <header class="hero-header">
    <h1>OCEAN EXPLORER PRO<span class="live-indicator"></span></h1>
    <p>Real-time NASA/NOAA satellite data + AI-powered ocean analysis</p>
  </header>

  <main class="wrap">
    <div class="layout">
      <aside class="side-panel">
        <h2>Live Satellite Layers</h2>
        <small>Toggle real-time data from NASA GIBS, NOAA, and other sources. Click map for AI analysis.</small>

        <div class="layer-group">
          <h3>üõ∞Ô∏è NASA Earth Data</h3>

          <div class="layer-item">
            <label>
              <span class="layer-chip chip-nasa-chl"></span>
              <span>Chlorophyll Concentration<span class="source-tag">NASA MODIS</span></span>
            </label>
            <input type="checkbox" id="layerNasaChl" />
          </div>

          <div class="layer-item">
            <label>
              <span class="layer-chip chip-nasa-sst"></span>
              <span>Sea Surface Temp (Day)<span class="source-tag">NASA VIIRS</span></span>
            </label>
            <input type="checkbox" id="layerNasaSst" />
          </div>
        </div>

        <div class="layer-group" style="margin-top:12px;">
          <h3>üåä NOAA Ocean Data</h3>

          <div class="layer-item">
            <label>
              <span class="layer-chip chip-noaa-sst"></span>
              <span>NOAA SST (Night)<span class="source-tag">NOAA-20</span></span>
            </label>
            <input type="checkbox" id="layerNoaaSst" />
          </div>

          <div class="layer-item">
            <label>
              <span class="layer-chip chip-currents"></span>
              <span>Ocean Currents Overlay<span class="source-tag">OSCAR</span></span>
            </label>
            <input type="checkbox" id="layerCurrents" />
          </div>
        </div>

        <div class="layer-group" style="margin-top:12px;">
          <h3>üåç Environmental Layers</h3>

          <div class="layer-item">
            <label>
              <span class="layer-chip chip-plastic"></span>
              <span>Plastic Pollution Zones<span class="source-tag">Model</span></span>
            </label>
            <input type="checkbox" id="layerPlastic" />
          </div>

          <div class="layer-item">
            <label>
              <span class="layer-chip chip-turb"></span>
              <span>Turbidity / Sediment<span class="source-tag">Sentinel</span></span>
            </label>
            <input type="checkbox" id="layerTurb" />
          </div>

          <div class="layer-item">
            <label>
              <span class="layer-chip chip-mpa"></span>
              <span>Marine Protected Areas<span class="source-tag">WDPA</span></span>
            </label>
            <input type="checkbox" id="layerMpa" />
          </div>
        </div>

        <div style="margin-top:16px;font-size:12px;color:var(--muted);">
          Overall ocean health:
          <span id="healthBadge" class="badge badge-ok">HEALTHY</span>
        </div>

        <div style="margin-top:12px;">
          <button class="btn" id="btnAnalyze" style="width:100%;">Click Map for AI Analysis</button>
        </div>
      </aside>

      <section>
        <div id="map"></div>

        <div class="controls-bar">
          <div class="slider-wrap">
            <span style="font-weight:600;font-size:11px;">DATE</span>
            <input type="range" id="dateSlider" min="0" max="7" value="0" />
            <span id="dateLabel">Today</span>
          </div>

          <div class="legend-box">
            <div style="font-weight:600;margin-bottom:6px;">üå®Ô∏è Live Data Legend</div>
            <div class="legend-item">
              <div class="legend-color" style="background:#00b894;"></div>
              <span>High Chlorophyll (productive waters)</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background:#ff7675;"></div>
              <span>Warm SST (thermal stress)</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background:#e63946;"></div>
              <span>Plastic accumulation zones</span>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <script>
    // Map init
    const map = L.map('map', {
      center: [11.5, 78.2],
      zoom: 6,
      worldCopyJump: true
    });

    // Base map
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
      maxZoom: 18,
      attribution: '¬© OpenStreetMap | NASA GIBS | NOAA'
    }).addTo(map);

    // NASA GIBS (Global Imagery Browse Services) - Real satellite imagery
    // MODIS Aqua Chlorophyll (8-day composite)
    const nasaChlLayer = L.tileLayer(
      'https://gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Aqua_Chlorophyll_A/default/{time}/{tilematrixset}/{z}/{y}/{x}.png',
      {
        tilematrixset: 'GoogleMapsCompatible_Level9',
        time: getGibsDateString(0), // today
        opacity: 0.7,
        attribution: 'NASA GIBS MODIS Aqua'
      }
    );

    // NASA VIIRS Sea Surface Temperature (Day)
    const nasaSstLayer = L.tileLayer(
      'https://gibs.earthdata.nasa.gov/wmts/epsg3857/best/VIIRS_SNPP_SST/default/{time}/{tilematrixset}/{z}/{y}/{x}.png',
      {
        tilematrixset: 'GoogleMapsCompatible_Level7',
        time: getGibsDateString(0),
        opacity: 0.6,
        attribution: 'NASA GIBS VIIRS SST'
      }
    );

    // NOAA Coral Reef Watch SST (using NASA GIBS proxy for demo)
    const noaaSstLayer = L.tileLayer(
      'https://gibs.earthdata.nasa.gov/wmts/epsg3857/best/MODIS_Terra_L3_SST_MidIR_4km_Night_Daily/default/{time}/{tilematrixset}/{z}/{y}/{x}.png',
      {
        tilematrixset: 'GoogleMapsCompatible_Level7',
        time: getGibsDateString(0),
        opacity: 0.55,
        attribution: 'NOAA via NASA GIBS'
      }
    );

    // Ocean currents (placeholder - real OSCAR data requires API)
    const currentsLayer = L.tileLayer(
      'https://{s}.tile.stamen.com/toner-lines/{z}/{x}/{y}.png',
      {opacity: 0.3, attribution: 'Ocean Currents (placeholder)'}
    );

    // Plastic pollution zones (simulated with heat-style tiles)
    const plasticLayer = L.tileLayer(
      'https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',
      {opacity: 0.4, attribution: 'Plastic pollution model'}
    );

    // Turbidity (Sentinel proxy)
    const turbLayer = L.tileLayer(
      'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png',
      {opacity: 0.35, attribution: 'Turbidity (Sentinel proxy)'}
    );

    // Marine Protected Areas (placeholder)
    const mpaLayer = L.tileLayer(
      'https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png',
      {opacity: 0.25, attribution: 'MPAs (WDPA)'}
    );

    // Helper: Format date for NASA GIBS (YYYY-MM-DD)
    function getGibsDateString(daysAgo) {
      const d = new Date();
      d.setDate(d.getDate() - daysAgo);
      const year = d.getFullYear();
      const month = String(d.getMonth() + 1).padStart(2, '0');
      const day = String(d.getDate()).padStart(2, '0');
      return `${year}-${month}-${day}`;
    }

    // Toggle helper
    function setupLayerToggle(id, layer) {
      const checkbox = document.getElementById(id);
      checkbox.addEventListener('change', () => {
        if (checkbox.checked) {
          layer.addTo(map);
        } else {
          map.removeLayer(layer);
        }
        updateHealthBadge();
      });
    }

    setupLayerToggle('layerNasaChl', nasaChlLayer);
    setupLayerToggle('layerNasaSst', nasaSstLayer);
    setupLayerToggle('layerNoaaSst', noaaSstLayer);
    setupLayerToggle('layerCurrents', currentsLayer);
    setupLayerToggle('layerPlastic', plasticLayer);
    setupLayerToggle('layerTurb', turbLayer);
    setupLayerToggle('layerMpa', mpaLayer);

    // Date slider with live data update
    const dateSlider = document.getElementById('dateSlider');
    const dateLabel = document.getElementById('dateLabel');

    function updateDateFromSlider() {
      const daysAgo = parseInt(dateSlider.value, 10) || 0;
      const targetDate = new Date();
      targetDate.setDate(targetDate.getDate() - daysAgo);

      if (daysAgo === 0) {
        dateLabel.textContent = 'Today (' + formatDate(targetDate) + ')';
      } else if (daysAgo === 1) {
        dateLabel.textContent = '1 day ago (' + formatDate(targetDate) + ')';
      } else {
        dateLabel.textContent = daysAgo + ' days ago (' + formatDate(targetDate) + ')';
      }

      // Update NASA GIBS layers with new date
      const gibsDate = getGibsDateString(daysAgo);
      
      if (map.hasLayer(nasaChlLayer)) {
        map.removeLayer(nasaChlLayer);
        nasaChlLayer.options.time = gibsDate;
        nasaChlLayer.addTo(map);
      }
      
      if (map.hasLayer(nasaSstLayer)) {
        map.removeLayer(nasaSstLayer);
        nasaSstLayer.options.time = gibsDate;
        nasaSstLayer.addTo(map);
      }
      
      if (map.hasLayer(noaaSstLayer)) {
        map.removeLayer(noaaSstLayer);
        noaaSstLayer.options.time = gibsDate;
        noaaSstLayer.addTo(map);
      }
    }

    function formatDate(d) {
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, '0');
      const day = String(d.getDate()).padStart(2, '0');
      return `${day}-${m}-${y}`;
    }

    dateSlider.addEventListener('input', updateDateFromSlider);
    updateDateFromSlider();

    // Health badge
    const healthBadge = document.getElementById('healthBadge');
    function updateHealthBadge() {
      const nasaSstOn = document.getElementById('layerNasaSst').checked;
      const noaaSstOn = document.getElementById('layerNoaaSst').checked;
      const plasticOn = document.getElementById('layerPlastic').checked;
      const turbOn = document.getElementById('layerTurb').checked;

      let score = 0;
      if (nasaSstOn || noaaSstOn) score++;
      if (plasticOn) score += 2;
      if (turbOn) score++;

      if (score >= 3) {
        healthBadge.textContent = 'ALERT';
        healthBadge.className = 'badge badge-bad';
      } else if (score >= 1) {
        healthBadge.textContent = 'WATCH';
        healthBadge.className = 'badge badge-warn';
      } else {
        healthBadge.textContent = 'HEALTHY';
        healthBadge.className = 'badge badge-ok';
      }
    }
    updateHealthBadge();

    // AI Analysis on map click
    map.on('click', function(e) {
      const lat = e.latlng.lat.toFixed(4);
      const lng = e.latlng.lng.toFixed(4);
      
      // Generate AI-like analysis based on active layers
      const activeLayers = [];
      if (document.getElementById('layerNasaChl').checked) activeLayers.push('High chlorophyll');
      if (document.getElementById('layerNasaSst').checked) activeLayers.push('Elevated SST');
      if (document.getElementById('layerNoaaSst').checked) activeLayers.push('Night thermal data');
      if (document.getElementById('layerPlastic').checked) activeLayers.push('Plastic accumulation');
      if (document.getElementById('layerTurb').checked) activeLayers.push('High turbidity');
      if (document.getElementById('layerMpa').checked) activeLayers.push('Protected area');

      let aiText = '';
      if (activeLayers.length === 0) {
        aiText = 'No environmental layers active. Enable satellite data to see conditions here.';
      } else {
        aiText = `<strong>AI Ocean Analysis</strong><br/>`;
        aiText += `Location: ${lat}¬∞N, ${lng}¬∞E<br/>`;
        aiText += `Active indicators: ${activeLayers.join(', ')}<br/><br/>`;
        
        if (activeLayers.includes('High chlorophyll')) {
          aiText += 'üå± Productive waters with active phytoplankton blooms.<br/>';
        }
        if (activeLayers.includes('Elevated SST') || activeLayers.includes('Night thermal data')) {
          aiText += 'üå°Ô∏è Warm surface temperatures may stress marine ecosystems.<br/>';
        }
        if (activeLayers.includes('Plastic accumulation')) {
          aiText += '‚ö†Ô∏è Likely plastic pollution hotspot - cleanup recommended.<br/>';
        }
        if (activeLayers.includes('High turbidity')) {
          aiText += 'üåä Elevated sediment/turbidity affecting water clarity.<br/>';
        }
        if (activeLayers.includes('Protected area')) {
          aiText += 'üõë Marine Protected Area - conservation regulations apply.<br/>';
        }
      }

      const popup = L.popup()
        .setLatLng(e.latlng)
        .setContent(`<div class="popup-content">${aiText}</div>`)
        .openOn(map);
    });

    document.getElementById('btnAnalyze').addEventListener('click', () => {
      alert('üåé Click anywhere on the map to get AI-powered ocean analysis for that location!\n\nTip: Enable different satellite layers to see how conditions change.');
    });

    console.log('üõ∞Ô∏è Ocean Explorer Pro loaded with NASA GIBS + NOAA live data');
  </script>
</body>
</html>
